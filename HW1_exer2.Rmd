---
title: "HW1 Exercise 2"
author: "Nathalie Mayor - Giovanni Magagnin - Alexandre Guerra - IDARGO Florent"
date: "3/3/2020"
output: html_document
---
---
title: <div align="center"> HW1 Exercise 2
author: <div align="center"> 
   Nathalie Mayor
  - Giovanni Magagnin
  - Florent Idargo
  - Alexandre Guerra
date: "3/3/2020"
output: html_document
---
```{r,echo=TRUE,results='hide',error=FALSE,message=FALSE,warning=FALSE}

quantmod::getSymbols(c("UBER","WORK","TWTR","CSCO"),src="yahoo", from="2019-01-01")
```


```{r}
stocks <- list(UBER[,4],WORK[,4],TWTR[,4],CSCO[,4])
par(mfrow= c(2,2))
titres <- list("UBER", "WORK", "TWTR","CSCO")

for (i in 1:4) {
  #titre <- stocks[[1]][0]
  leGraph <- plot(stocks[[i]],main = titres[i])
  print(leGraph)
}


```


```{r,echo=FALSE}
library(quantmod)


### 4 CANDLES

today<-Sys.Date()
four_months_ago <- seq(today, length = 2, by = "-4 months")[2]
```

```{r,echo=TRUE,results='hide',error=FALSE,message=FALSE,warning=FALSE}
getSymbols(c("UBER","WORK","TWTR","CSCO"),src="yahoo", from=four_months_ago)
```

```{r,echo=FALSE,warning=FALSE}
candleChart(UBER, theme = 'white', type = 'candles')

candleChart(WORK, theme = 'white', type = 'candles')

candleChart(TWTR, theme = 'white', type = 'candles')

candleChart(CSCO, theme = 'white', type = 'candles')


### 5 MEAN AND VAR OF TS
(ten_years_ago<-seq(today, length = 2, by = "-10 years")[2])
paste("The ten years ago date is:", toString(ten_years_ago),sep=" ")
```

```{r,echo=FALSE,results='hide',error=FALSE,message=FALSE,warning=FALSE}
getSymbols(c("UBER","WORK","TWTR","CSCO"),src="yahoo", from=ten_years_ago)
```

```{r,echo=T}

UBER_returns <- na.omit(ClCl(UBER[,4]))
mean_UBER<-mean(UBER_returns)
var_UBER<-var(UBER_returns)
paste("The mean daily return since UBER's inception is:", toString(mean_UBER),sep=" ")
paste("The mean daily variance since UBER's inception is:", toString(var_UBER),sep=" ")
paste("As an indicative value, the mean daily volatility since UBER's inception is:", toString(sqrt(var_UBER)))


WORK_returns <- na.omit(ClCl(WORK[,4]))
mean_WORK <- mean(WORK_returns)
var_WORK <- var(WORK_returns)
paste("The mean daily return over ten years of WORK is:", toString(mean_WORK),sep=" ")
paste("The mean daily variance  over ten years of WORK is:", toString(var_WORK),sep=" ")
paste("As an indicative value, the mean daily volatility since WORK's inception is:", toString(sqrt(var_WORK)))

TWTR_returns <- na.omit(ClCl(TWTR[,4]))
mean_TWTR <- mean(TWTR_returns)
var_TWTR <- var(TWTR_returns)
paste("The mean daily return over ten years of WORK is:", toString(mean_TWTR),sep=" ")
paste("The mean daily variance over ten years of WORK is:", toString(var_TWTR),sep=" ")
paste("As an indicative value, the mean daily volatility since TWTR's inception is:", toString(sqrt(var_TWTR)))

CSCO_returns <- na.omit(ClCl(CSCO[,4]))
mean_CSCO <- mean(CSCO_returns)
var_CSCO <- var(CSCO_returns)
paste("The mean daily return over ten years of WORK is:", toString(mean_CSCO),sep=" ")
paste("The mean daily variance over ten years of WORK is:", toString(var_CSCO),sep=" ")
paste("As an indicative value, the mean daily volatility from the ten past years of CSCO is:", toString(sqrt(var_CSCO)))

### 6

annual_returns<-periodReturn(UBER,period = 'yearly',subset = '2010::')
excessreturns<-annual_returns-0.03
sharpe<-mean(annual_returns)/sd(annual_returns)
#print(sharpe)
paste("The sharpe ratio of UBER is:", toString(sharpe),sep=" ")

annual_returns<-periodReturn(WORK,period = 'yearly',subset = '2010::')
excessreturns<-annual_returns-0.03
sharpe<-mean(annual_returns)/sd(annual_returns)
#print(sharpe)
paste("The sharpe ratio of WORK is:", toString(sharpe),sep=" ")


annual_returns<-periodReturn(TWTR,period = 'yearly',subset = '2010::')
excessreturns<-annual_returns-0.03
sharpe<-mean(annual_returns)/sd(annual_returns)
#print(sharpe)
paste("The sharpe ratio of TWTR is:", toString(sharpe),sep=" ")

annual_returns<-periodReturn(CSCO,period = 'yearly',subset = '2010::')
excessreturns<-annual_returns-0.03
sharpe<-mean(annual_returns)/sd(annual_returns)
#print(sharpe)
paste("The sharpe ratio of CSCO is:", toString(sharpe),sep=" ")

```
### Question 7
```{r}

#####7
quantmod::getSymbols(c("UBER","WORK","TWTR","CSCO"),src="yahoo", from="2020-01-01")
stocks <- list(UBER[,4],WORK[,4],TWTR[,4],CSCO[,4])
cumulated_var <- 0

historique <- data.frame(uber_returns = ClCl(UBER[,4]),work_returns = ClCl(WORK[,4]),twtr_returns = ClCl(TWTR[,4]),csco_returns = ClCl(CSCO[,4]))
historique <- historique[-1,]

#Variance of the portofolio
covariance_matrix <- matrix(cov(historique),ncol=4,nrow=4)
weight_matrix <- matrix(rep(0.25,4),ncol=1,nrow=4)
weight_matrix_transpose <- matrix(rep(0.25,4),ncol=4,nrow=1)

variance_equally_weighted_portofolio <- weight_matrix_transpose %*% covariance_matrix %*% weight_matrix
paste("The variance of the return of an equally weighted portofolio built of these four stocks is:", toString(round(variance_equally_weighted_portofolio,digits=6)), "and the volatility is:", toString(round(sqrt(variance_equally_weighted_portofolio),digit=5)), sep=" ")

#single stocks average var

for (stock in historique) {
  cumulated_var <- cumulated_var + var(stock)
}
average_var_single_stock_portofolio = cumulated_var/4

paste("The average variance of a portofolio made of 100% of one of these stocks is:", toString(round((cumulated_var/4),digits=5)), "and its average volatility would therefore be:",toString(round(sqrt((cumulated_var/4)),digits=5)))
```
We therefore observe that the volatility and variance of a single stock portofolio is consistently superior to the 4 equally weighted assets portofolio and has an approximately `r round((average_var_single_stock_portofolio/variance_equally_weighted_portofolio),digits=2)` higher variance. This clearly unerline the benefits from diversification.







